% -*- coding: utf-8 -*-
\chapter{イントロダクション}
\label{ch:introduction}

朝起きて、ごはんをよそい、味噌汁を作る。
ご飯を食べて、職場に向かう。最寄駅まで歩き、電車に乗って職場への電車に乗る。

何故、人はごはんをよそうことが出来るのだろうか？
ごはんをよそうためにしゃもじを右手にとり、茶碗を左手に持つ。
炊飯器を空けて、ごはんをかき混ぜる。
かき混ぜたらごはんをしゃもじの上に乗せて、茶碗の上に持っていく。
しゃもじを回転させると、ごはんは茶碗に落ちる。

とても、とても難しいことをやっていると思わないだろうか？
不思議なことに、我々は「ごはんをよそう」と頭にあるだけ(と自覚している)だけなのに、何故かそのために必要な行動を列挙し、一つずつ実行していけるのである。

何故、我々は殆ど頭を(自覚的に)使わずにこのような計画を立てることが出来るのだろうか？何故ごはんをよそうためにお湯を沸かしたり、最寄り駅まで歩いたりする必要はないと分かるのだろうか？
それは我々が無限に近い可能な行動の集合の中から{\bf 直感} (ヒューリスティック)的に目的を達成するために必要そうな行動を絞り込むことが出来るからである。

この直感をコンピュータに実装することこそが高度な先読みをし、高度な行動計画を行い実行の出来るシステム、人工知能に肝要なのではないか。
本書で扱う{\bf ヒューリスティック探索}はその仮説に基づき、直感を用いた行動計画を行う研究分野である。

%人は様々な問題を探索によって解決している。
%例えば飛行機で成田からロンドンに行く安い/速い方法などを計画するのは探索の一つである。
%一昔前は探索こそが人類の知であるという価値観が広くあり、囲碁、将棋、チェスなどのゲームはそれを競う競技であるとして。
%あるいは囲碁、将棋、チェスなどのゲームも、ある手を選んだ時にどのような局面につながるのかを先読みし、選ぶべき次の一手を探索する。
%このような様々な問題はグラフ探索問題として統合してモデルすることが出来る。
%もちろん、それぞれの問題はそれぞれの特徴があり、それぞれで効率的な解法が異なる。

%\captionlistentry[todo]{Introduction: なんかいい感じの絵}
%{\TODO いい感じの絵}


\section{何故人工知能に探索が必要なのか}
\label{sec:why-search}

グラフ探索アルゴリズムは人工知能に限らず情報科学に多岐に渡って有用な手法である。
本書では特に人工知能の要素技術としての問題を扱うために解説する。

人工知能とは何か、と考えることは本書の主眼ではない。
人工知能の教科書として有名なArtificial Intelligence: Modern Approach \cite{russelln03}では人工知能と呼ばれる研究は主に以下の４つの目標を目指していると説明している。

\begin{mdframed}[backgroundcolor=gray!10, roundcorner=10pt]
\begin{enumerate}
\item Think Rationally (合理的に考える)
\item Think Humanly (人間的に考える)
\item Act Rationally (合理的に行動する)
\item Act Humanly (人間的に行動する)
\end{enumerate}
\end{mdframed}

グラフ探索アルゴリズムは主にThink Rationallyを実現するための技術である\footnote{探索は４つ全てに強く関係しているが本書は主にThink Rationallyに注視する}。
探索によって\define{先読み}{lookahead}{さきよみ}をし、最も合理的な手を選ぶというのが目的である。

先読みをするという点が機械学習によるThink Rationallyと異なる点である。
機械学習は過去に学習した経験を元に合理的な行動を選ぶというアイディアである。
それに対して、探索は未来にどういう経験をするかを先読みして合理的な行動を選ぶ。

探索技術の大きな課題・欠点は世界のモデルを必要とする点である。
モデルがないと未来にどういう経験をするかを先読みすることができない。
例えば将棋であれば各コマがどのように動き、敵の王を詰ますと勝ち、といった情報を与えなければならない。加えてどの場面の時にどちらがどのくらい有利なのかという場面の評価値がないと強いエージェントは作れない。
モデルは完璧である必要はないが、先読みをするためには有用なものでなくてはならない。

%探索は特に学習データを得ることが難しい・不可能なシステムに用いられてきた。
なので、探索は世界のモデルが容易に得られる問題において用いられてきた。
例えば経路探索問題など地図があればおおよその距離が推定できる。
今後のNASAなどによる宇宙開発でも探索技術が重要であり続けると考えられている。NASAのウェブページを見ると過去と現在の探索技術を用いたプロジェクトがたくさん紹介されている \footnote{\url{https://ti.arc.nasa.gov/tech/asr/planning-and-scheduling/}}。


探索と機械学習は組み合わせて用いることでより賢い行動が出来るようになると考えられ、研究されている。
モンテカルロ木探索とディープラーニングを組み合わせてプロ棋士に勝利したAlphaGoなどはまさに探索と機械学習を組み合わせたエージェントの強力さを体現しているといえるだろう \cite{silver2016mastering}。これはディープラーニングによって場面と次の一手の評価値を機械学習で学び、それと探索を組み合わせて良い評価値の場面につながるような手を選んでいくということをしている。
もう一つの組み合わせ方としては機械学習によってモデルを学習し、それを使って探索をするという方法がある。前述のように探索にはモデルが必要であるというのが重要な問題である。例えばAtariでディープラーニングを使って探索のためのモデルを学習する研究がある \cite{oh2015action,silver2016predictron,chiappa2017recurrent}。

このように、探索アルゴリズムは人工知能技術を理解する上で欠かせない分野の一つである。
特に最近大きなブレイクスルーのあった機械学習・深層学習とも強いシナジーを持っているため、これから大きな進展があると期待される分野の一つであると言えるだろう。

%Think RationallyとAct Rationallyの間には大きなギャップが存在する。

\begin{comment}
\section{アルゴリズムの概略図}
\label{sec:cheatsheet}

ここでは大まかに問題の特徴に対してどのようなアルゴリズムを最初に試すべきかの概略を示す。
ここで紹介する手法が常に優れているわけではない。が、最初に考慮する価値はあるだろう。
つまり、ここではその問題に当てはまらないとされた手法だからといって有用ではないということはない。
各章を読んでみて、適用可能かを読んでみたい。

\begin{enumerate}
\item 同じ状態に至る経路がたくさんある
	\begin{enumerate}
	\item YES: グラフ探索アルゴリズム
	\item NO: 木探索アルゴリズム (e.g. IDA*)
	\item SOSO: IDA* with transposition table
	\end{enumerate}
	
\item 問題の特徴がある程度分かっておりヒューリスティック関数が作れる
	\begin{enumerate}
	\item YES: ヒューリスティック探索
	\item NO: ブラインド探索
	\end{enumerate}

\item 最適解ではなくある程度良い解なら十分である
	\begin{enumerate}
	\item YES: 局所探索、weighted A*
	\item NO: A*
	\end{enumerate}

\item 最適解と比べてどのくらい良い解かの保証が必要である
	\begin{enumerate}
	\item YES: weighted A*
	\item NO: Greedy best first search
	\end{enumerate}

\item 実行時間が足りない
	\begin{enumerate}
	\item YES: 局所探索、IDA*、weighted A*、並列探索
	\end{enumerate}

\item メモリが足りない
	\begin{enumerate}
	\item YES: 深さ優先探索、IDA*、並列探索、外部メモリ探索、
	\end{enumerate}

\item 状態空間に似たような状態がたくさんある
	\begin{enumerate}
	\item YES: Novelty-based Pruning
	\end{enumerate}

\item 最適解のコストの上界が求められる
	\begin{enumerate}
	\item YES: branch-and-bound
	\end{enumerate}

\item コスト(ノード間距離)は連続値である
	\begin{enumerate}
	\item YES: 二分木によるプライオリティキュー
	\item NO: (離散値) nested bucketによるプライオリティキュー
	\end{enumerate}

\item 分枝数が大きい
	\begin{enumerate}
	\item YES: 遅延重複検出
	\end{enumerate}

\item いろいろな種類の問題を解かなければならない
	\begin{enumerate}
	\item YES: PDDL、自動行動計画問題
	\end{enumerate}

%解を一つではなく全列挙したい
%YES: Symbolic Search?

%あるアクションの後に実行すると有益なアクションが分かっている
%YES: マクロアクション
\end{enumerate}
\end{comment}


\section{本書の射程}
\label{sec:coverage}

本書では\define{状態空間問題}{state-space problem}{じょうたいくうかんもんだい}を主な対象として扱う。
グラフ探索アルゴリズムはこれに限らず様々な場面で使われるがこの本では状態空間問題に注目する。
状態空間問題は与えられたゴールに到達するための行動の列、\define{プラン}{plan}{プラン}を発見する問題である。

本書が主に扱うの状態空間問題のうち
\define{完全情報}{perfect information}{かんぜんじょうほう}かつ\define{決定論的}{deterministic}{けっていろんてき}モデルである(\ref{ch:state-space-problem}~\ref{ch:heuristic-search-variants}章
)。

世界を正確に表現することは不可能である。
よって、殆どの問題はより解きやすい問題に{\bf モデル化}され、モデル化された問題を解くことによって解きたい問題を解決するというのがエンジニアリングである。

どのように世界をモデルするかは非常に難しい問題である。
モデルを簡単なものにすればするほど解きやすくなるが、簡単で正しいモデルをデザインする・自動生成することは非常に難しい。
それだけでなくモデルが人間にとって理解しやすいものであるか、似たような他の問題にも適用可能か、様々なモデルの「良さ」が考えられる。

完全情報とは、エージェントが世界の状態を全て観察できるモデルである。神の目線に立っている。
これに対して\define{不完全情報}{partial infomation}{ふかんぜんじょうほう}モデルではエージェントは世界の状態を知ることは出来ず、代わりに\define{観察}{observation}{かんさつ}をすることで世界の状態の一部を知ることが出来る。
実世界で動くロボットなどを考えると不完全情報モデルの方が現実的であるが、多くの問題が完全情報で十二分に表現することが出来る。

決定論的とはエージェントの行動によって世界の状態がどのように遷移するかが一意に(決定論的)に定まることである。
非決定論的モデルでは遷移が一意に定まらない。同じ状態から同じアクションを取ったとしても、世界がどのように変化するかは一意に定まらない。
非決定論的モデルにおける探索問題は本書では扱わない。興味があれば強化学習の教科書を読むと良い\cite{sutton1998introduction}。

%モデルを自動生成する方法については\ref{sec:domain-acquisition}章でも簡単に触れるが、本書の主眼ではない。

本書が扱う完全情報決定論的モデルはシンプルなモデルである。
これを対象としてグラフ探索アルゴリズムの解説をする。
%より複雑なモデルに対してはより複雑なアルゴリズムを考える必要がある
%これを不完全情報、非決定論的モデルとすることでより元の問題も表現しやすくなることがあるが、一方でモデルのシンプルさを失うことになる。



% TODO: グラフの用語を定義する？
